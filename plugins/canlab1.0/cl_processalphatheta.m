function cl_processalphatheta(subj, exportpath)
% Outputs results of cl_alphatheta to CSV file
table{100,100} = [];
table{1,1}  = 'SubjectID';
table{1,2}  = 'C3AlphaThetaRatio';
table{1,3}  = 'C3AlphaThetaRatio_fixed';
table{1,4}  = 'O1AlphaThetaRatio';
table{1,5}  = 'O1AlphaThetaRatio_fixed';
table{1,6}  = 'avgC3AlphaThetaRatio';
table{1,7}  = 'avgC3AlphaThetaRatio_fixed';
table{1,8}  = 'avgO1AlphaThetaRatio';
table{1,9}  = 'avgO1AlphaThetaRatio_fixed';
table{1,10} = 'C3_IAF';
table{1,11} = 'C3_TF';
table{1,12} = 'O1_IAF';
table{1,13} = 'O1_TF';
table{1,14} = 'C3DeltaPower';
table{1,15} = 'C3ThetaPower';
table{1,16} = 'C3AlphaPower';
table{1,17} = 'C3Alpha1Power';
table{1,18} = 'C3Alpha2Power';
table{1,19} = 'C3Alpha3Power';
table{1,20} = 'C3BetaPower';
table{1,21} = 'C3GammaPower';
table{1,22} = 'O1DeltaPower';
table{1,23} = 'O1ThetaPower';
table{1,24} = 'O1AlphaPower';
table{1,25} = 'O1Alpha1Power';
table{1,26} = 'O1Alpha2Power';
table{1,27} = 'O1Alpha3Power';
table{1,28} = 'O1BetaPower';
table{1,29} = 'O1GammaPower';
table{1,30} = 'C3DeltaPower_fixed';
table{1,31} = 'C3ThetaPower_fixed';
table{1,32} = 'C3AlphaPower_fixed';
table{1,33} = 'C3Alpha1Power_fixed';
table{1,34} = 'C3Alpha2Power_fixed';
table{1,35} = 'C3Alpha3Power_fixed';
table{1,36} = 'C3BetaPower_fixed'
table{1,37} = 'C3GammaPower_fixed';
table{1,38} = 'O1DeltaPower_fixed';
table{1,39} = 'O1ThetaPower_fixed';
table{1,40} = 'O1AlphaPower_fixed';
table{1,41} = 'O1Alpha1Power_fixed';
table{1,42} = 'O1Alpha2Power_fixed';
table{1,43} = 'O1Alpha3Power_fixed';
table{1,44} = 'O1BetaPower_fixed';
table{1,45} = 'O1GammaPower_fixed';
table{1,46} = 'C3DeltaFloor';
table{1,47} = 'C3ThetaFloor';
table{1,48} = 'C3AlphaFloor';
table{1,49} = 'C3Alpha1Floor';
table{1,50} = 'C3Alpha2Floor';
table{1,51} = 'C3Alpha3Floor';
table{1,52} = 'C3BetaFloor';
table{1,53} = 'C3GammaFloor';
table{1,54} = 'O1DeltaFloor';
table{1,55} = 'O1ThetaFloor';
table{1,56} = 'O1AlphaFloor';
table{1,57} = 'O1Alpha1Floor';
table{1,58} = 'O1Alpha2Floor';
table{1,59} = 'O1Alpha3Floor';
table{1,60} = 'O1BetaFloor';
table{1,61} = 'O1GammaFloor';
table{1,62} = 'DeltaFloor_fixed';
table{1,63} = 'ThetaFloor_fixed';
table{1,64} = 'AlphaFloor_fixed';
table{1,65} = 'Alpha1Floor_fixed';
table{1,66} = 'Alpha2Floor_fixed';
table{1,67} = 'Alpha3Floor_fixed';
table{1,68} = 'BetaFloor_fixed';
table{1,69} = 'GammaFloor_fixed';

for i = 1:numel(subj)
    table{i+1,1}  = subj(i).SubjectID;
    table{i+1,2}  = subj(i).C3AlphaThetaRatio;
    table{i+1,3}  = subj(i).C3AlphaThetaRatio_fixed;
    table{i+1,4}  = subj(i).O1AlphaThetaRatio;
    table{i+1,5}  = subj(i).O1AlphaThetaRatio_fixed;
    table{i+1,6}  = subj(i).avgC3AlphaThetaRatio;
    table{i+1,7}  = subj(i).avgC3AlphaThetaRatio_fixed;
    table{i+1,8}  = subj(i).avgO1AlphaThetaRatio;
    table{i+1,9}  = subj(i).avgO1AlphaThetaRatio_fixed;
    table{i+1,10}  = subj(i).C3meanIAF;
    table{i+1,11}  = subj(i).C3meanTF;
    table{i+1,12}  = subj(i).O1meanIAF;
    table{i+1,13}  = subj(i).O1meanTF;
    table{i+1,14} = subj(i).C3deltaPower; 
    table{i+1,15} = subj(i).C3thetaPower;
    table{i+1,16} = subj(i).C3alphaPower;
    table{i+1,17} = subj(i).C3alpha1Power;
    table{i+1,18} = subj(i).C3alpha2Power;
    table{i+1,19} = subj(i).C3alpha3Power;
    table{i+1,20} = subj(i).C3betaPower;
    table{i+1,21} = subj(i).C3gammaPower;
    table{i+1,22} = subj(i).O1deltaPower;
    table{i+1,23} = subj(i).O1thetaPower;
    table{i+1,24} = subj(i).O1alphaPower;
    table{i+1,25} = subj(i).O1alpha1Power;
    table{i+1,26} = subj(i).O1alpha2Power;
    table{i+1,27} = subj(i).O1alpha3Power;
    table{i+1,28} = subj(i).O1betaPower;
    table{i+1,29} = subj(i).O1gammaPower;
    table{i+1,30} = subj(i).C3deltaPower_fixed;
    table{i+1,31} = subj(i).C3thetaPower_fixed;
    table{i+1,32} = subj(i).C3alphaPower_fixed;
    table{i+1,33} = subj(i).C3alpha1Power_fixed;
    table{i+1,34} = subj(i).C3alpha2Power_fixed;
    table{i+1,35} = subj(i).C3alpha3Power_fixed;
    table{i+1,36} = subj(i).C3betaPower_fixed;
    table{i+1,37} = subj(i).C3gammaPower_fixed;
    table{i+1,38} = subj(i).O1deltaPower_fixed;
    table{i+1,39} = subj(i).O1thetaPower_fixed;
    table{i+1,40} = subj(i).O1alphaPower_fixed;
    table{i+1,41} = subj(i).O1alpha1Power_fixed;
    table{i+1,42} = subj(i).O1alpha2Power_fixed;
    table{i+1,43} = subj(i).O1alpha3Power_fixed;
    table{i+1,44} = subj(i).O1betaPower_fixed;
    table{i+1,45} = subj(i).O1gammaPower_fixed;
    table{i+1,46} = subj(i).C3deltaFloor;
    table{i+1,47} = subj(i).C3thetaFloor;
    table{i+1,48} = subj(i).C3alphaFloor;
    table{i+1,49} = subj(i).C3alpha1Floor;
    table{i+1,50} = subj(i).C3alpha2Floor;
    table{i+1,51} = subj(i).C3alpha3Floor;
    table{i+1,52} = subj(i).C3betaFloor;
    table{i+1,53} = subj(i).C3gammaFloor;
    table{i+1,54} = subj(i).O1deltaFloor;
    table{i+1,55} = subj(i).O1thetaFloor;
    table{i+1,56} = subj(i).O1alphaFloor;
    table{i+1,57} = subj(i).O1alpha1Floor;
    table{i+1,58} = subj(i).O1alpha2Floor;
    table{i+1,59} = subj(i).O1alpha3Floor;
    table{i+1,60} = subj(i).O1betaFloor;
    table{i+1,61} = subj(i).O1gammaFloor;
    table{i+1,62} = subj(i).deltaFloor_fixed;
    table{i+1,63} = subj(i).thetaFloor_fixed;
    table{i+1,64} = subj(i).alphaFloor_fixed;
    table{i+1,65} = subj(i).alpha1Floor_fixed;
    table{i+1,66} = subj(i).alpha2Floor_fixed;
    table{i+1,67} = subj(i).alpha3Floor_fixed;
    table{i+1,68} = subj(i).betaFloor_fixed;
    table{i+1,69} = subj(i).gammaFloor_fixed;
end

resultsCSV = strcat(exportpath, '/', date, '-results', '.csv');
cell2csv(resultsCSV, table);
end
